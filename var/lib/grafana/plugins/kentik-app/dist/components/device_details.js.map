{"version":3,"sources":["../../src/components/device_details.js"],"names":["DeviceDetailsCtrl","$scope","$injector","$location","backendSrv","alertSrv","device","deviceDTO","pageReady","getDevice","search","other_ips","push","ip","index","splice","deviceId","get","then","resp","updateDeviceDTO","device_name","url","device_id","id","device_type","device_description","device_flow_type","device_sample_rate","parseInt","minimize_snmp","device_snmp_ip","device_snmp_community","device_bgp_type","device_bgp_password","device_bgp_neighbor_ip","device_bgp_neighbor_asn","data","put","set","err","error","templateUrl"],"mappings":"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","file":"device_details.js","sourcesContent":["export class DeviceDetailsCtrl {\n\n\t/** @ngInject */\n  constructor($scope, $injector, $location, backendSrv, alertSrv) {\n    this.backendSrv = backendSrv;\n    this.alertSrv = alertSrv;\n    this.$location = $location;\n    this.device = {};\n    this.deviceDTO = {};\n    this.pageReady = false;\n    this.getDevice($location.search().device);\n  }\n\n  addIP() {\n    this.other_ips.push({ip: ''});\n  }\n\n  removeIP(index) {\n    this.other_ips.splice(index, 1);\n  }\n\n  getDevice(deviceId) {\n    this.backendSrv.get(\"/api/plugin-proxy/kentik-app/api/v5/device/\" + deviceId)\n      .then(resp => {\n        this.device = resp.device;\n        this.updateDeviceDTO();\n        this.pageReady = true;\n      });\n  }\n\n  gotoDashboard(device_name) {\n    this.$location.url(\"/dashboard/db/kentik-top-talkers?var-device=\" + device_name);\n  }\n\n  updateDeviceDTO() {\n    this.deviceDTO = {\n      device_id: this.device.id,\n      device_name: this.device.device_name,\n      device_type: this.device.device_type,\n      device_description: this.device.device_description,\n      device_flow_type: this.device.device_flow_type,\n      device_sample_rate: parseInt(this.device.device_sample_rate),\n      minimize_snmp: this.device.minimize_snmp,\n      device_snmp_ip:        this.device.device_snmp_ip,\n      device_snmp_community: this.device.device_snmp_community,\n      device_bgp_type:         this.device.device_bgp_type,\n      device_bgp_password:     this.device.device_bgp_password,\n      device_bgp_neighbor_ip:  this.device.device_bgp_neighbor_ip,\n      device_bgp_neighbor_asn: parseInt(this.device.device_bgp_neighbor_asn)\n    };\n  }\n\n  update() {\n    if (!this.deviceDTO.device_snmp_ip) {\n      delete this.deviceDTO.device_snmp_ip;\n    }\n    if (!this.deviceDTO.device_snmp_community) {\n      delete this.deviceDTO.device_snmp_community;\n    }\n    let data = {device: this.deviceDTO};\n\n    this.backendSrv.put(\"/api/plugin-proxy/kentik-app/api/v5/device/\" + this.deviceDTO.device_id, data)\n      .then(resp => {\n        if ('err' in resp) {\n          this.alertSrv.set(\"Device Update failed.\", resp.err, 'error');\n        } else {\n          this.alertSrv.set(\"Device Updated.\", this.deviceDTO.device_name, 'success', 3000);\n          return this.getDevice(this.deviceDTO.device_id);\n        }\n      }, error => {\n        if ('error' in error.data) {\n          this.alertSrv.set(\"Device Update failed.\", error.data.error, 'error');\n        } else {\n          this.alertSrv.set(\"Device Update failed.\", error, 'error');\n        }\n      });\n  }\n}\n\nDeviceDetailsCtrl.templateUrl = 'components/device_details.html';\n"]}